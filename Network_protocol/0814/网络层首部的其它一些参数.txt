
网络层介于传输层和数据链路层之间，其主要作用是实现两个不同网络系统之间的数据透明传送，具体包括路由选择，拥塞控制和网际互连等。
网络层负责在不同的网络之间(基于数据包的IP地址)尽力转发数据包，不负责丢包重传和接收顺序。

如果只是同一局域网内的各个计算机之间的通信，单靠物理层和数据链路层就可以建立通信链路完成用户间的数据通信，
但要扩大应用范围，连接不同的局域子网，就需要借助网络层处理各个网络子网的协议，从而进行计算机的网络互连，所以网络层在 TCP/IP 协议体系中叫网际互连层。




网络层数据包(IP数据包, Packet) 由首部、数据2部分组成
数据: 很多时候是由传输层传递下来的数据段(Segment)
 
---- 因为还有些协议是 只有两层/三层--->  比如工作在数据链路层的PPP协议 以及 以太网的CSMA/CD协议工作在数据链路层并没有网络层


网络层（通常指的是IP层）的首部中有许多重要的字段，其中“生存时间”（Time to Live，TTL）、“协议”（Protocol）、“首部校验和”（Header Checksum）是非常关键的三个参数。下面是对它们的解释：

1. 生存时间（Time to Live，TTL）

    定义：生存时间是一个8位字段，用来限制一个数据包在网络中的寿命。
    作用：TTL的初始值由源主机设置，每经过一个路由器，在经过之前该值就会减1。当TTL值减少到0时，数据包将被丢弃，并且发送回一个ICMP超时报文给源主机。
    目的：防止数据包在网络中无限循环（可能由于路由环路引起），从而耗尽网络资源。

TTL减到零的逻辑图步骤：
开始（Start）

数据包进入路由器或主机。
检查TTL值（Check TTL value）

获取数据包的TTL字段值。
TTL == 0？（Is TTL = 0?）

是（Yes）：
发送ICMP超时报文给源主机（Send ICMP Time Exceeded message to source）。
丢弃数据包（Discard the packet）。
结束（End）。
否（No）：
转到下一步。
TTL减1（Decrease TTL by 1）

将TTL值减1（Decrement TTL value by 1）。
转发数据包（Forward the packet）

将数据包转发到下一跳（Forward the packet to the next hop）。
结束（End）。





2. 协议（Protocol）

    定义：协议字段也是一个8位字段，指定了IP层上承载的数据属于哪个高层协议。
    常见值：不同的协议对应不同的值，比如：
        1：ICMP（Internet Control Message Protocol）
        6：TCP（Transmission Control Protocol）
        17：UDP（User Datagram Protocol）
    作用：帮助网络层识别所承载的上层数据，以便将其交给正确的传输层协议进行处理。

3. 首部校验和（Header Checksum）

    定义：首部校验和是一个16位字段，用于检测IP首部在传输过程中是否发生错误。
    计算方法：对IP首部的每两个字节（16位）进行二进制反码求和，然后将结果的反码写入校验和字段。接收方在收到数据包时，会重新计算校验和并与该字段进行比较，如果不匹配，则说明首部发生了错误。
    作用：确保IP首部在传输过程中没有被损坏，从而提高传输的可靠性。
    这三个参数都是确保数据包在网络中能够被正确路由、传输和处理的重要机制。




而 ARP协议 、IP协议、ICMP协议 直接工作在网络层不属于运输层
ARP协议、IP协议、ICMP协议是网络通信中非常重要的三个协议，各自承担着不同的功能。以下是对它们的作用的简要说明：

1. ARP协议（Address Resolution Protocol）
作用：ARP协议的主要功能是将IP地址解析为对应的物理地址（通常是MAC地址）。它位于网络层和链路层之间，确保数据能够通过网络物理传输。
工作流程：
当设备A需要与设备B通信时，设备A已知设备B的IP地址，但不知道其MAC地址。
设备A在其子网内广播一个ARP请求，询问谁拥有特定的IP地址。
拥有该IP地址的设备B回应一个ARP应答，将自己的MAC地址发送给设备A。
设备A接收到应答后，将IP地址和MAC地址映射关系存入ARP缓存，以后发送数据时直接使用。
应用场景：ARP通常用于局域网（LAN）内设备之间的通信，因为在局域网中，数据帧是通过MAC地址来发送的。

2. IP协议（Internet Protocol）
作用：IP协议是整个互联网协议栈中的核心协议，负责在不同的网络之间传递数据包。它定义了数据包的格式、地址结构，并提供路由功能，将数据从源设备发送到目的设备。
工作流程：
IP协议将传输层（如TCP、UDP）产生的数据段封装成IP数据包。
IP协议为每个数据包分配一个源IP地址和目的IP地址，用于网络路由和转发。
数据包在网络中通过多跳（经过多个路由器）传递，最终到达目的地。
在目的设备，IP协议将数据包解封装并交付给上层协议处理。
特点：IP协议是无连接的和不可靠的，这意味着它不保证数据包的顺序和交付（这需要由传输层协议如TCP来保证）。

3. ICMP协议（Internet Control Message Protocol）
作用：ICMP协议主要用于网络设备之间传递控制信息和错误报告。它不用于传输用户数据，而是用于网络管理和诊断。
工作流程：
错误报告：当一个路由器或主机在处理IP数据包时遇到问题（如无法到达目的地、TTL超时等），它会发送ICMP错误报文（如“目标不可达”）给源主机。
诊断工具：ICMP协议支持一些网络诊断工具，如ping和traceroute。ping使用ICMP回显请求和回显应答报文来检查目标主机是否可达，并测量往返时间。
网络控制：ICMP报文还可用于网络流量控制，例如通过ICMP Redirect指引主机使用更优的路由路径。
应用场景：ICMP广泛用于网络监控、排障和维护工作，帮助网络管理员了解网络状态和性能。
这三种协议协同工作，确保网络通信的高效性和可靠性：ARP确保局域网内的地址解析，IP提供基本的网络传输功能，而ICMP则负责网络控制和错误报告。



每一行的解释：
来自 110.242.68.66 的回复: 字节=32 时间=94ms TTL=53

字节=32: 发送的数据包大小为32字节。
时间=94ms: 从你发送请求到收到回复的往返时间为94毫秒。
TTL=53: Time To Live (生存时间)，表示数据包在网络中可以经过的最大路由器数，这个值减小到0时，数据包会被丢弃。通常，这个值用于诊断网络中转路径的长短。
数据包: 已发送 = 4，已接收 = 4，丢失 = 0 (0% 丢失)

已发送 = 4: 一共发送了4个数据包。
已接收 = 4: 收到了4个数据包的回复。
丢失 = 0 (0% 丢失): 没有数据包丢失，网络连接没有出现数据丢失的情况。
往返行程的估计时间(以毫秒为单位): 最短 = 90ms，最长 = 351ms，平均 = 191ms

最短 = 90ms: 最快的一个请求的往返时间为90毫秒。
最长 = 351ms: 最慢的一个请求的往返时间为351毫秒。
平均 = 191ms: 平均往返时间为191毫秒。
总结:
ping 测试表明与 baidu.com 的网络连接稳定，没有数据包丢失。
但是，往返时间波动较大，从90毫秒到351毫秒不等，这可能是由于网络路径中的某些跳跃点出现了临时的网络拥塞或者其他网络延迟问题。




